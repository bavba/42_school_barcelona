/**
 * @file 
 * @brief This file contains the tsunami program.
 */

#include <stdio.h>
#include <string.h>

/**
 * @brief A function vulnerable to buffer overflow.
 *
 * This function takes an input string and copies it into a fixed-size buffer without proper bounds checking.
 * As a result, it is susceptible to buffer overflow attacks.
 *
 * @param input The input string to be copied into the buffer.
 */
void vulnerable_function(char *input) {
    char buffer[10]; /**< The buffer where the input string is copied. */

    strcpy(buffer, input); /**< Copy the input string into the buffer without bounds checking. */

    printf("Input: %s\n", buffer); /**< Print the content of the buffer. */
}

/**
 * @brief The main function.
 *
 * This function takes an input argument and passes it to the vulnerable_function.
 * If no input argument is provided, the usage message is displayed.
 *
 * @param argc The number of command-line arguments.
 * @param argv An array of command-line argument strings.
 * @return Returns 0 upon successful execution.
 */
int main(int argc, char *argv[]) {
    if (argc < 2) {
        printf("Usage: %s <input>\n", argv[0]); /**< Display the usage message. */
        return 1;
    }
    
    vulnerable_function(argv[1]); /**< Call the vulnerable_function with the provided input. */

    return 0; /**< Return 0 to indicate successful execution. */
}
